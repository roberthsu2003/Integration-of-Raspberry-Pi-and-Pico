# 程式碼審查檢核表

本文件提供程式碼審查的標準和檢核項目。

## 📋 審查流程

### 1. 提交前自我檢查
在提交程式碼前，請先自我檢查以下項目。

### 2. 同儕審查
由其他開發者或教師進行審查。

### 3. 測試驗證
確保程式碼通過所有測試。

---

## ✅ 程式碼品質檢核

### 基本要求

#### 語法和格式
- [ ] 程式碼沒有語法錯誤
- [ ] 遵循 PEP 8 規範（Python）
- [ ] 縮排統一（4 空格）
- [ ] 行長度不超過 100 字元
- [ ] 檔案結尾有換行符號

#### 命名規範
- [ ] 變數名稱有意義且清晰
- [ ] 函式名稱描述其功能
- [ ] 類別名稱使用 PascalCase
- [ ] 變數和函式使用 snake_case
- [ ] 常數使用 UPPER_CASE
- [ ] 避免使用單字母變數（除了迴圈計數器）

#### 程式碼結構
- [ ] 函式長度適中（< 50 行）
- [ ] 類別職責單一
- [ ] 避免過深的巢狀結構（< 4 層）
- [ ] 程式碼模組化
- [ ] 重複的程式碼已提取為函式

---

## 📝 文件和註解檢核

### 註解品質
- [ ] 所有程式碼都有適當的中文註解
- [ ] 註解說明「為什麼」而不只是「做什麼」
- [ ] 複雜邏輯有詳細說明
- [ ] 沒有被註解掉的廢棄程式碼
- [ ] 沒有 TODO 或 FIXME（或已記錄在 Issue）

### 文件字串
- [ ] 所有公開函式都有文件字串
- [ ] 所有類別都有文件字串
- [ ] 文件字串包含功能說明
- [ ] 文件字串包含參數說明
- [ ] 文件字串包含回傳值說明
- [ ] 文件字串包含使用範例（如適用）

### 範例
```python
def calculate_temperature(reading: float) -> float:
    """
    將 ADC 讀數轉換為溫度值
    
    使用 Pico 內建溫度感測器的轉換公式：
    T = 27 - (V - 0.706) / 0.001721
    
    Args:
        reading: ADC 讀數（0-65535）
        
    Returns:
        float: 溫度值（攝氏度）
        
    Example:
        >>> reading = sensor.read_u16()
        >>> temp = calculate_temperature(reading)
        >>> print(f"溫度: {temp:.1f}°C")
    """
    voltage = reading * (3.3 / 65535)
    temperature = 27 - (voltage - 0.706) / 0.001721
    return temperature
```

---

## 🛡️ 錯誤處理檢核

### 異常處理
- [ ] 所有可能失敗的操作都有錯誤處理
- [ ] 使用適當的異常類型
- [ ] 不使用空的 except 區塊
- [ ] 錯誤訊息清晰且有幫助
- [ ] 提供錯誤修復建議

### 輸入驗證
- [ ] 驗證所有外部輸入
- [ ] 檢查參數範圍
- [ ] 處理邊界情況
- [ ] 防止無效資料

### 範例
```python
def connect_mqtt(broker: str, port: int = 1883) -> bool:
    """連接到 MQTT Broker"""
    # 驗證輸入
    if not broker:
        raise ValueError("Broker 地址不能為空")
    if not (1 <= port <= 65535):
        raise ValueError(f"Port 必須在 1-65535 之間，收到: {port}")
    
    try:
        client.connect(broker, port)
        print(f"✓ 已連接到 {broker}:{port}")
        return True
    except ConnectionError as e:
        print(f"✗ 連接失敗: {e}")
        print("請檢查：")
        print("  1. Broker 是否正在運行")
        print("  2. 網路連接是否正常")
        print("  3. 防火牆設定")
        return False
    except Exception as e:
        print(f"✗ 未預期的錯誤: {e}")
        return False
```

---

## 🔒 安全性檢核

### 敏感資訊
- [ ] 沒有硬編碼的密碼
- [ ] 沒有硬編碼的 API 金鑰
- [ ] 沒有硬編碼的 IP 位址（除了範例）
- [ ] 使用環境變數或配置檔案
- [ ] 敏感資訊不在版本控制中

### 輸入安全
- [ ] 防止 SQL 注入（如適用）
- [ ] 防止命令注入
- [ ] 驗證檔案路徑
- [ ] 限制檔案大小

---

## ⚡ 效能檢核

### 效率
- [ ] 避免不必要的迴圈
- [ ] 避免重複計算
- [ ] 使用適當的資料結構
- [ ] 避免記憶體洩漏
- [ ] 關閉不再使用的資源

### 資源管理
- [ ] 檔案正確關閉
- [ ] 網路連接正確關閉
- [ ] 使用 context manager（with 語句）
- [ ] 避免無限迴圈

### 範例
```python
# 好的做法
with open('data.txt', 'r') as f:
    data = f.read()
# 檔案自動關閉

# 不好的做法
f = open('data.txt', 'r')
data = f.read()
# 忘記關閉檔案
```

---

## 🧪 測試檢核

### 測試覆蓋
- [ ] 核心功能有測試
- [ ] 邊界情況有測試
- [ ] 錯誤情況有測試
- [ ] 測試可以獨立執行
- [ ] 測試結果可重現

### 測試品質
- [ ] 測試名稱清楚描述測試內容
- [ ] 每個測試只測試一件事
- [ ] 測試不依賴執行順序
- [ ] 測試資料不影響生產環境

---

## 📚 教學適用性檢核

### 學習友善
- [ ] 程式碼易於理解
- [ ] 範例完整可執行
- [ ] 有清晰的使用說明
- [ ] 有預期的輸出範例
- [ ] 有常見問題說明

### 漸進式學習
- [ ] 從簡單到複雜
- [ ] 每個範例建立在前一個基礎上
- [ ] 避免突然的難度跳躍
- [ ] 提供練習題

---

## 📖 文件檢核

### README 檔案
- [ ] 有清晰的標題和說明
- [ ] 有安裝步驟
- [ ] 有使用範例
- [ ] 有預期輸出
- [ ] 有故障排除指南

### 程式碼範例
- [ ] 範例完整可執行
- [ ] 範例有註解說明
- [ ] 範例涵蓋主要功能
- [ ] 範例展示最佳實踐

---

## 🔍 審查檢核表

### 提交前檢查
```markdown
- [ ] 程式碼沒有語法錯誤
- [ ] 所有測試都通過
- [ ] 程式碼有適當的註解
- [ ] 函式有文件字串
- [ ] 沒有硬編碼的敏感資訊
- [ ] 錯誤處理完善
- [ ] 程式碼格式統一
- [ ] README 已更新
- [ ] 沒有不必要的檔案
- [ ] Git commit 訊息清晰
```

### 審查者檢查
```markdown
- [ ] 程式碼邏輯正確
- [ ] 程式碼易於理解
- [ ] 命名清晰有意義
- [ ] 沒有重複的程式碼
- [ ] 錯誤處理適當
- [ ] 效能可接受
- [ ] 安全性考慮周全
- [ ] 文件完整
- [ ] 測試充分
- [ ] 符合專案規範
```

---

## 🎯 品質標準

### 優秀（⭐⭐⭐⭐⭐）
- 所有檢核項目都通過
- 程式碼清晰易懂
- 文件完整詳細
- 測試覆蓋充分
- 可作為範例

### 良好（⭐⭐⭐⭐）
- 大部分檢核項目通過
- 程式碼可以理解
- 文件基本完整
- 有基本測試
- 可以使用

### 需要改進（⭐⭐⭐）
- 部分檢核項目未通過
- 程式碼需要改進
- 文件不夠完整
- 測試不足
- 需要修改

### 不合格（⭐⭐）
- 多數檢核項目未通過
- 程式碼難以理解
- 文件缺失
- 沒有測試
- 需要重寫

---

## 🛠️ 自動化工具

### Python 程式碼檢查
```bash
# 語法檢查
python -m py_compile your_file.py

# 程式碼風格檢查
flake8 your_file.py

# 型別檢查
mypy your_file.py

# 格式化
black your_file.py
```

### 批次檢查
```bash
# 檢查所有 Python 檔案
find . -name "*.py" -exec python -m py_compile {} \;

# 格式化所有 Python 檔案
find . -name "*.py" -exec black {} \;
```

---

## 📝 審查範本

### Pull Request 審查範本
```markdown
## 程式碼審查

### ✅ 通過項目
- 程式碼邏輯正確
- 註解清晰
- 測試通過

### ⚠️ 需要改進
- [ ] 第 45 行：建議加入錯誤處理
- [ ] 第 78 行：變數名稱可以更清楚
- [ ] 缺少文件字串

### 💡 建議
- 考慮將這個函式拆分為兩個
- 可以加入更多測試案例

### 總體評價
⭐⭐⭐⭐ 良好，修改後可以合併
```

---

## 🎓 教學用途

### 學生作業審查
```markdown
## 作業評分

### 功能完整性（40%）
- [ ] 實作所有要求的功能
- [ ] 程式可以正常執行
- [ ] 輸出結果正確

### 程式碼品質（30%）
- [ ] 程式碼結構清晰
- [ ] 命名規範
- [ ] 有適當的註解

### 文件（20%）
- [ ] 有 README 說明
- [ ] 有使用範例
- [ ] 有執行步驟

### 創新性（10%）
- [ ] 有額外的功能
- [ ] 有創新的實作方式

### 總分：____ / 100
```

---

## 📞 支援

如有問題：
- 查看 [CONTRIBUTING.md](CONTRIBUTING.md)
- 參考 [程式碼範例](01_pico_basics/)
- 提交 GitHub Issue

---

**最後更新：** 2025-10-11
**版本：** 1.0.0
